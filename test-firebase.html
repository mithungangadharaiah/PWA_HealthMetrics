<!DOCTYPE html>
<html>
<head>
    <title>Firebase Test</title>
    <style>
        body { font-family: Arial; padding: 20px; background: #f0f0f0; }
        .test { background: white; padding: 15px; margin: 10px 0; border-radius: 5px; border-left: 4px solid #ccc; }
        .success { border-left-color: green; }
        .error { border-left-color: red; }
        button { padding: 15px 30px; background: #4285f4; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 16px; margin: 10px 0; }
        button:hover { background: #357ae8; }
    </style>
</head>
<body>
    <h1>üî• Firebase Authentication Test</h1>
    
    <div id="test-1" class="test">
        <strong>Test 1:</strong> Firebase SDK Loaded
        <div id="result-1">Testing...</div>
    </div>
    
    <div id="test-2" class="test">
        <strong>Test 2:</strong> Firebase Config Loaded
        <div id="result-2">Testing...</div>
    </div>
    
    <div id="test-3" class="test">
        <strong>Test 3:</strong> Firebase Initialized
        <div id="result-3">Testing...</div>
    </div>
    
    <div id="test-4" class="test">
        <strong>Test 4:</strong> Google Sign-In
        <div id="result-4">
            <button onclick="testSignIn()">üîê Click to Test Sign-In</button>
            <div id="signin-result"></div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="firebase-config.js"></script>

    <script>
        // Test 1: Check if Firebase is loaded
        if (typeof firebase !== 'undefined') {
            document.getElementById('result-1').innerHTML = '‚úÖ Firebase SDK loaded successfully!';
            document.getElementById('test-1').classList.add('success');
        } else {
            document.getElementById('result-1').innerHTML = '‚ùå Firebase SDK not loaded!';
            document.getElementById('test-1').classList.add('error');
        }

        // Test 2: Check if config is loaded
        if (window.FIREBASE_CONFIG) {
            document.getElementById('result-2').innerHTML = '‚úÖ Firebase config loaded!<br><code>' + JSON.stringify(window.FIREBASE_CONFIG, null, 2) + '</code>';
            document.getElementById('test-2').classList.add('success');
        } else {
            document.getElementById('result-2').innerHTML = '‚ùå Firebase config not found!';
            document.getElementById('test-2').classList.add('error');
        }

        // Test 3: Initialize Firebase
        let auth = null;
        try {
            firebase.initializeApp(window.FIREBASE_CONFIG);
            auth = firebase.auth();
            document.getElementById('result-3').innerHTML = '‚úÖ Firebase initialized successfully!';
            document.getElementById('test-3').classList.add('success');
        } catch (error) {
            document.getElementById('result-3').innerHTML = '‚ùå Firebase initialization failed:<br>' + error.message;
            document.getElementById('test-3').classList.add('error');
        }

        // Test 4: Sign-In Function
        async function testSignIn() {
            const resultDiv = document.getElementById('signin-result');
            resultDiv.innerHTML = '‚è≥ Opening Google Sign-In popup...';
            
            try {
                const provider = new firebase.auth.GoogleAuthProvider();
                provider.addScope('email');
                provider.addScope('profile');
                
                console.log('Attempting sign-in...');
                const result = await auth.signInWithPopup(provider);
                const user = result.user;
                
                resultDiv.innerHTML = '‚úÖ SUCCESS! Signed in as:<br>' +
                    '<strong>' + user.email + '</strong><br>' +
                    '<img src="' + user.photoURL + '" style="width: 50px; border-radius: 50%; margin-top: 10px;">';
                document.getElementById('test-4').classList.add('success');
                
                console.log('‚úÖ Sign-in successful:', user);
            } catch (error) {
                resultDiv.innerHTML = '‚ùå Sign-in failed:<br>' +
                    '<strong>Error Code:</strong> ' + error.code + '<br>' +
                    '<strong>Error Message:</strong> ' + error.message + '<br><br>' +
                    '<em>Common fixes:</em><br>' +
                    '1. Add "localhost" to Firebase Authorized Domains<br>' +
                    '2. Enable pop-ups in your browser<br>' +
                    '3. Check if Google Sign-In is enabled in Firebase Console';
                document.getElementById('test-4').classList.add('error');
                
                console.error('‚ùå Sign-in error:', error);
            }
        }

        // Listen for auth state
        if (auth) {
            auth.onAuthStateChanged((user) => {
                if (user) {
                    console.log('‚úÖ User is signed in:', user.email);
                } else {
                    console.log('‚ÑπÔ∏è No user signed in');
                }
            });
        }
    </script>
</body>
</html>
